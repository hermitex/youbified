
// enable CORS without external module
app.use(function (req, res, next) {
  res.header("Access-Control-Allow-Origin", "*");
  res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
  next();
});

app.use(express.static(path.join(__dirname)));


// parse application/json
app.use(bodyParser.json());
// parse application/x-www-form-urlencoded
app.use(bodyParser.urlencoded({ extended: true }));
 
// request handlers
app.get("/", (req, res) => {
  res.sendFile(path.join(__dirname, "index.html"));
});


app.get('/test', (req, res) => {
    res.status(200).json({ message: 'Enable CORS in Node.js - Clue Mediator' });
  });

// Create a livestream
app.get("/create", (req, res) => {
  const options = {
    method: "POST",
    url: "https://api.liveapi.com/live_streams",
    headers: {
      Accept: "application/json",
      Authorization:
        "Basic aGQxZ25OU2JkNzVnOmQ5M0ZEN3dTeEkzcjc5SnNtblQ3SWltRnllOUFERkw3a0FuNQ==",
    },
  };

  axios
    .request(options)
    .then(function (response) {
      let data = response.data;
      res.json(data);
    })
    .catch(function (error) {
      console.error(error);
    });
});

// console.log('listening on port ' + process.env.PORT)
